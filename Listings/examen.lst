C51 COMPILER V9.60.0.0   EXAMEN                                                            05/14/2023 23:13:24 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE EXAMEN
OBJECT MODULE PLACED IN .\Objects\examen.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE examen.c OPTIMIZE(8,SPEED) BROWSE NOAREGS DEBUG OBJECTEXTEND PRINT(.\Lis
                    -tings\examen.lst) TABS(2) OBJECT(.\Objects\examen.obj)

line level    source

   1          #include <reg552.h>
   2          
   3          #define BASE_DE_TIEMPO 250
   4          #define FREQ_OCS       11.0592
   5          #define DESB_x_SEG     4000
   6          
   7          // Declaracion de funciones
   8          void inicializar(void);
   9          
  10          // Salidas P4
  11          // Cohetes
  12          sbit cohete1 = 0xC0;
  13          sbit cohete2 = 0xC1;
  14          sbit cohete3 = 0xC2;
  15          // Seguridad
  16          sbit guillotina = 0xC7;
  17          
  18          // Entradas P1
  19          sbit disparo    = 0x90;
  20          sbit EMERGENCIA = 0x97;
  21          
  22          // Variables globales
  23          unsigned long int contador;
  24          unsigned char TL_0, TH_0;
  25          unsigned char SEGURIDAD; // VARIABLE PARA CONTROLAR EL DISPARO DE SETA DE SEGURIDAD
  26          unsigned char DISPARADO;
  27          
  28          void main(void)
  29          {
  30   1      
  31   1          // Inicializa
  32   1          inicializar();
  33   1      
  34   1          while (1) {
  35   2      
  36   2              while ((disparo == 0) && (DISPARADO == 0) && (EMERGENCIA == 0)) {
  37   3                  // Todas las salidas a cero listas
  38   3                  cohete1    = 0;
  39   3                  cohete2    = 0;
  40   3                  cohete3    = 0;
  41   3                  guillotina = 0;
  42   3                  // contador para el ciclo lo mantenemos en cero
  43   3                  contador = 0;
  44   3              }
  45   2              if (disparo) {
  46   3                  DISPARADO = 1;
  47   3              }
  48   2          }
  49   1      }
  50          
  51          /*################# FUNCIONES ######################*/
  52          
  53          // CONFIGURACION//
  54          
C51 COMPILER V9.60.0.0   EXAMEN                                                            05/14/2023 23:13:24 PAGE 2   

  55          void inicializar(void)
  56          {
  57   1      
  58   1          // Variables locales
  59   1          unsigned char valor_carga_inical;
  60   1      
  61   1          // Configuracion timer 0  modo 2 (10) 8bits con autorecarga
  62   1          TMOD = TMOD | 0x02;
  63   1      
  64   1          // Calculo y carga del temporizador
  65   1          valor_carga_inical = (0xFF - 1) - BASE_DE_TIEMPO * FREQ_OCS / 12.0;
  66   1          TL_0               = valor_carga_inical;
  67   1          TH_0               = valor_carga_inical;
  68   1          TL0                = TL_0;
  69   1          TH0                = TH_0;
  70   1      
  71   1          // Interruciones
  72   1          EA  = 1; // Interrpciones globales
  73   1          ET0 = 1; // Interrupcion timer0
  74   1      
  75   1          // Salidas a cero por seguridad
  76   1          cohete1    = 0;
  77   1          cohete2    = 0;
  78   1          cohete3    = 0;
  79   1          guillotina = 0;
  80   1      
  81   1          // Control disparo de seguridad
  82   1          SEGURIDAD = 0;
  83   1      
  84   1          // TR0 START
  85   1          TR0 = 1;
  86   1      }
  87          ////////////////////////////////////////////////////////////////////////////////
  88          
  89          // INTERRUPCION TR0//
  90          
  91          void interrupcionTR0(void) interrupt 1 using 3
  92          {
  93   1      
  94   1          // Variables locales
  95   1      
  96   1          // Sumamos un desbrodamiento SI ESTAMOS EN MARCHA
  97   1          if (DISPARADO == 1) {
  98   2              contador++;
  99   2          }
 100   1      
 101   1          if ((contador > 0) && (contador < (5 * DESB_x_SEG)) && (EMERGENCIA == 0)) {
 102   2              // Disparamos el primer choete
 103   2              cohete1   = 1;
 104   2              DISPARADO = 1;
 105   2          }
 106   1      
 107   1          if (contador == (5 * DESB_x_SEG) && (EMERGENCIA == 0)) {
 108   2              cohete2   = 1;
 109   2              DISPARADO = 1;
 110   2          }
 111   1      
 112   1          if (contador == (8 * DESB_x_SEG) && (EMERGENCIA == 0)) {
 113   2              cohete3   = 1;
 114   2              DISPARADO = 1;
 115   2          }
 116   1      
C51 COMPILER V9.60.0.0   EXAMEN                                                            05/14/2023 23:13:24 PAGE 3   

 117   1          if (contador == (48000) && (EMERGENCIA == 0)) {
 118   2              cohete1   = 0;
 119   2              cohete2   = 0;
 120   2              cohete3   = 0;
 121   2              DISPARADO = 0;
 122   2              contador  = 0;
 123   2          }
 124   1      
 125   1          if (EMERGENCIA == 1) {
 126   2      
 127   2              // Corte de mechas
 128   2              guillotina = 1;
 129   2      
 130   2              // Desactivacion pines de disparo
 131   2              cohete1 = 0;
 132   2              cohete2 = 0;
 133   2              cohete3 = 0;
 134   2      
 135   2              while (EMERGENCIA == 1) {
 136   3                  // mientras se espera el reset de emergencia se inicializan los parameetros necesarios para vo
             -lver al modo espera
 137   3                  DISPARADO  = 0;
 138   3                  contador   = 0;
 139   3                  guillotina = 0;
 140   3              }
 141   2          }
 142   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    294    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
